<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>D·ª± ƒëo√°n Ti·ªÉu ƒë∆∞·ªùng</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

  <h1>üî¨ H·ªá th·ªëng d·ª± ƒëo√°n Ti·ªÉu ƒë∆∞·ªùng</h1>

  <form method="POST">
    <div class="form-group">
      <label for="gender">Gi·ªõi t√≠nh 
        <span class="info" title="Gi·ªõi t√≠nh c·ªßa b·ªánh nh√¢n (Nam, N·ªØ ho·∫∑c Kh√°c).">‚ÑπÔ∏è</span>
      </label>
      <select name="gender" required>
        <option value="Male">Nam</option>
        <option value="Female">N·ªØ</option>
        <option value="Other">Kh√°c</option>
      </select>
    </div>

    <div class="form-group">
      <label for="age">Tu·ªïi 
        <span class="info" title="Tu·ªïi ·∫£nh h∆∞·ªüng ƒë·∫øn nguy c∆° m·∫Øc b·ªánh ti·ªÉu ƒë∆∞·ªùng.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" name="age" min="0" max="120" required>
    </div>

    <div class="form-group">
      <label for="hypertension">Cao huy·∫øt √°p 
        <span class="info" title="Ng∆∞·ªùi b·ªã cao huy·∫øt √°p c√≥ nguy c∆° cao h∆°n m·∫Øc ti·ªÉu ƒë∆∞·ªùng.">‚ÑπÔ∏è</span>
      </label>
      <select name="hypertension" required>
        <option value="0">Kh√¥ng</option>
        <option value="1">C√≥</option>
      </select>
    </div>

    <div class="form-group">
      <label for="heart_disease">B·ªánh tim 
        <span class="info" title="Ti·ªÉu ƒë∆∞·ªùng th∆∞·ªùng ƒëi k√®m v·ªõi c√°c b·ªánh tim m·∫°ch.">‚ÑπÔ∏è</span>
      </label>
      <select name="heart_disease" required>
        <option value="0">Kh√¥ng</option>
        <option value="1">C√≥</option>
      </select>
    </div>

    <div class="form-group">
      <label for="smoking_history">H√∫t thu·ªëc 
        <span class="info" title="H√∫t thu·ªëc l√†m tƒÉng nguy c∆° m·∫Øc nhi·ªÅu b·ªánh, bao g·ªìm ti·ªÉu ƒë∆∞·ªùng.">‚ÑπÔ∏è</span>
      </label>
      <select name="smoking_history" required>
        <option value="never">Kh√¥ng h√∫t</option>
        <option value="former">ƒê√£ t·ª´ng</option>
        <option value="current">ƒêang h√∫t</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="bmi">Ch·ªâ s·ªë BMI 
        <span class="info" title="BMI (Body Mass Index) cho bi·∫øt m·ª©c ƒë·ªô g·∫ßy, b√¨nh th∆∞·ªùng hay th·ª´a c√¢n/d∆∞ c√¢n.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" step="0.1" name="bmi" required>
    </div>

    <div class="form-group">
      <label for="HbA1c_level">HbA1c Level 
        <span class="info" title="HbA1c ph·∫£n √°nh m·ª©c ƒë∆∞·ªùng huy·∫øt trung b√¨nh trong 2-3 th√°ng g·∫ßn nh·∫•t.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" step="0.1" name="HbA1c_level" required>
    </div>

    <div class="form-group">
      <label for="blood_glucose_level">ƒê∆∞·ªùng huy·∫øt 
        <span class="info" title="ƒê∆∞·ªùng huy·∫øt ƒëo l∆∞·ª£ng glucose trong m√°u t·∫°i th·ªùi ƒëi·ªÉm hi·ªán t·∫°i.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" step="0.1" name="blood_glucose_level" required>
    </div>

    <button type="submit">D·ª± ƒëo√°n</button>
  </form>

  {% if results %}
  <div class="results">
    <h2>üìä K·∫øt qu·∫£ d·ª± ƒëo√°n</h2>
    <table>
      <tr>
        <th>M√¥ h√¨nh</th>
        <th>D·ª± ƒëo√°n</th>
        <th>X√°c su·∫•t m·∫Øc b·ªánh</th>
      </tr>
      {% for model, (pred, prob) in results.items() %}
      <tr>
        <td>{{ model }}</td>
        <td>{{ "C√≥" if pred==1 else "Kh√¥ng" }}</td>
        <td>{{ "%.2f"|format(prob*100) }}%</td>
      </tr>
      {% endfor %}
    </table>
  </div>
  {% endif %}

  <div class="charts">
    <h2>üìà So s√°nh m√¥ h√¨nh</h2>
    <img src="{{ url_for('accuracy_chart') }}" alt="Bi·ªÉu ƒë·ªì ƒë·ªô ch√≠nh x√°c">
    <img src="{{ url_for('chart') }}" alt="Bi·ªÉu ƒë·ªì x√°c su·∫•t">
    
    <h3>üîé Ch·ªâ s·ªë ƒë√°nh gi√° m√¥ h√¨nh</h3>
    <table>
      <tr>
        <th>M√¥ h√¨nh</th>
        <th>Accuracy</th>
        <th>MAE</th>
        <th>MSE</th>
        <th>R¬≤</th>
      </tr>
      {% for model, vals in metrics.items() %}
      <tr>
        <td>{{ model }}</td>
        <td>{{ "%.2f"|format(vals["ACC"]*100) }}%</td>
        <td>{{ "%.4f"|format(vals["MAE"]) }}</td>
        <td>{{ "%.4f"|format(vals["MSE"]) }}</td>
        <td>{{ "%.4f"|format(vals["R2"]) }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>

</body>
</html>
